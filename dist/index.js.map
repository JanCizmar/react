{"version":3,"file":"index.js","sources":["../src/FeedbackModal.tsx","../src/index.tsx"],"sourcesContent":["import * as React from \"react\";\n\ntype Props = {\n  projectId: string;\n  identifier?: string;\n  onClose: () => void;\n};\nexport default function FeedbackModal(props: Props) {\n  const [feedback, setFeedback] = React.useState(\"\");\n  const [showSpinner, setShowSpinner] = React.useState(false);\n  const [modalTitle, setModalTitle] = React.useState(\"Give feedback!\");\n  const [feedbackButtonText, setFeedbackButtonText] =\n    React.useState(\"Send Feedback\");\n  const [state, setState] = React.useState<\"ask\" | \"conclusion\">(\"ask\");\n\n  function handleSubmitFeedback() {\n    if (state === \"conclusion\") {\n      setFeedback(\"\");\n      setShowSpinner(false);\n      setState(\"ask\");\n      setModalTitle(\"Give feedback!\");\n      setFeedbackButtonText(\"Send Feedback\");\n      return;\n    }\n\n    if (!feedback) {\n      return;\n    }\n\n    setShowSpinner(true);\n    setState(\"conclusion\");\n    setModalTitle(\"Thank you!\");\n    setFeedbackButtonText(\"Another thing to say?\");\n\n    setShowSpinner(false);\n  }\n\n  function handleKeyDown(event: any) {\n    if (event.key === \"Enter\" && event.metaKey) {\n      handleSubmitFeedback();\n    }\n  }\n\n  const spin = `\\\n   \n       100% { -moz-transform: rotate(360deg); } \n       100% { -webkit-transform: rotate(360deg); } \n       100% { \n           -webkit-transform: rotate(360deg); \n           transform:rotate(360deg); \n       } \n   }\n   `;\n\n  return (\n    <div\n      style={{\n        width: 300,\n        minHeight: 150,\n        backgroundColor: \"white\",\n        borderRadius: 7,\n        boxShadow: \"rgb(0 0 0 / 27%) 5px 5px 15px 0px\",\n        display: \"flex\",\n        zIndex: 9999,\n        padding: 10,\n        flexDirection: \"column\",\n        justifyContent: \"space-between\",\n        fontFamily: \"helvetica, arial\",\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          width: \"100%\",\n          display: \"flex\",\n          fontWeight: \"bold\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n        }}\n      >\n        <p style={{ margin: 0, color: \"black\" }}>{modalTitle}</p>\n        <button\n          style={{\n            width: 20,\n            height: 20,\n            background: \"none\",\n            padding: 0,\n            border: 0,\n            cursor: \"pointer\",\n          }}\n          onClick={props.onClose}\n        >\n          <svg\n            width=\"12px\"\n            height=\"12px\"\n            viewBox=\"0 0 20 20\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              id=\"Path\"\n              d=\"M19.773 16.809 L12.94 9.953 19.789 3.186 C20.07 2.905 20.07 2.447 19.789 2.166 L17.841 0.208 C17.706 0.073 17.523 0 17.331 0 17.138 0 16.956 0.078 16.82 0.208 L10.003 6.955 3.174 0.213 C3.039 0.078 2.857 0.005 2.664 0.005 2.471 0.005 2.289 0.083 2.154 0.213 L0.211 2.171 C-0.07 2.452 -0.07 2.91 0.211 3.191 L7.06 9.958 0.232 16.809 C0.096 16.944 0.018 17.126 0.018 17.319 0.018 17.512 0.091 17.694 0.232 17.829 L2.18 19.787 C2.32 19.927 2.503 20 2.69 20 2.872 20 3.06 19.932 3.201 19.787 L10.003 12.957 16.81 19.781 C16.951 19.922 17.133 19.995 17.32 19.995 17.503 19.995 17.69 19.927 17.831 19.781 L19.779 17.824 C19.914 17.689 19.992 17.507 19.992 17.314 19.987 17.126 19.909 16.944 19.773 16.809 Z\"\n              fill=\"#aeaeae\"\n              stroke=\"none\"\n            />\n          </svg>\n        </button>\n      </div>\n\n      {state === \"ask\" && (\n        <textarea\n          autoFocus\n          placeholder=\"I really ...\"\n          style={{\n            marginTop: 12,\n            borderRadius: 7,\n            fontSize: 14,\n            resize: \"none\",\n            height: 55,\n            color: \"black\",\n            backgroundColor: \"white\",\n            borderColor: \"rgba(51,51,51,0.2)\",\n            wordBreak: \"break-word\",\n            padding: 10,\n            fontFamily: \"helvetica, arial\",\n          }}\n          onKeyDown={handleKeyDown}\n          onChange={(e) => setFeedback(e.target.value)}\n        ></textarea>\n      )}\n\n      {state === \"conclusion\" && (\n        <p\n          style={{\n            marginTop: 16,\n            marginBottom: 16,\n            color: \"black\",\n            textAlign: \"left\",\n          }}\n        >\n          Your feedback has been received!\n        </p>\n      )}\n      {/* Footer */}\n      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n        <button\n          style={{\n            cursor: \"pointer\",\n            backgroundColor: !feedback\n              ? \"rgba(51,51,51,0.2)\"\n              : \"rgb(13, 166, 125)\",\n            borderRadius: 7,\n            marginTop: 16,\n            padding: 6,\n            color: \"white\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            fontFamily: \"helvetica, arial\",\n            border: 0,\n            height: 35,\n          }}\n          onClick={handleSubmitFeedback}\n        >\n          {feedbackButtonText}\n          {showSpinner && (\n            <div\n              style={{\n                paddingTop: 2,\n                paddingBottom: 2,\n                marginLeft: 10,\n              }}\n            >\n              <div\n                style={{\n                  border: \"10px solid #f3f3f3\",\n                  borderTop: \"10px solid #0da67d\",\n                  borderRadius: \"50%\",\n                  WebkitAnimation: `${spin} 4s linear infinite`,\n                  animation: `${spin} 4s linear infinite`,\n                }}\n              ></div>\n            </div>\n          )}\n        </button>\n        <span\n          style={{\n            fontSize: 12,\n            fontFamily: \"helvetica, arial\",\n            textAlign: \"center\",\n            marginTop: 12,\n            color: \"rgb(174,174,174)\",\n          }}\n        >\n          Powered by{\" \"}\n          <a\n            href=\"https://feedback.farm\"\n            target=\"_blank\"\n            style={{ color: \"rgb(13,166,125)\", textDecoration: \"none\" }}\n          >\n            feedback.farm\n          </a>\n        </span>\n      </div>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { usePopper } from \"react-popper\";\nimport FeedbackModal from \"./FeedbackModal\";\n\ntype Props = {\n  children: React.ReactNode;\n  projectId: string;\n  identifier?: string;\n};\n\n// https://stackoverflow.com/questions/32553158/detect-click-outside-react-component\nfunction useOutsideAlerter(ref: any, onClose: () => void) {\n  React.useEffect(() => {\n    function handleClickOutside(event: any) {\n      if (ref.current && !ref.current.contains(event.target)) {\n        onClose();\n      }\n    }\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [ref]);\n}\n\nfunction FeedbackFarm(props: Props) {\n  const [visible, setVisibility] = React.useState(true);\n\n  const [referenceRef, setReferenceRef] = React.useState(null);\n  const [popperRef, setPopperRef] = React.useState(null);\n\n  const { styles, attributes } = usePopper(referenceRef, popperRef, {\n    placement: \"auto\",\n  });\n\n  const wrapperRef = React.useRef(null);\n  useOutsideAlerter(wrapperRef, () => setVisibility(false));\n\n  return (\n    <div ref={wrapperRef}>\n      <div\n        // @ts-ignore\n        ref={setReferenceRef}\n        onClick={() => setVisibility(true)}\n        style={{ cursor: \"pointer\" }}\n      >\n        {props.children}\n      </div>\n      {/* @ts-ignore */}\n      <div ref={setPopperRef} style={styles.popper} {...attributes.popper}>\n        {visible && (\n          <FeedbackModal\n            onClose={() => setVisibility(false)}\n            projectId={props.projectId}\n            identifier={props.identifier}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default FeedbackFarm;\n"],"names":["React","usePopper"],"mappings":"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"}